(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[3],{"013f":function(t,e,o){"use strict";o.r(e);var s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{staticClass:"window-height window-width row justify-center items-center"},[o("div",{staticClass:"column q-pa-lg"},[o("strong",{staticClass:"text-h6"},[t._v(t._s(t.message))]),o("q-card-section",{},[o("div",{staticClass:"row"},[o("q-img",{attrs:{src:t.imageSrc,transition:"scale-transition",width:"50px"}}),o("strong",{staticClass:"text-h6 q-ml-md q-my-md"},[t._v("DeltaBX")])],1)]),o("q-separator",{attrs:{color:"orange",size:"5px"}}),o("q-card-section",[o("q-form",{staticClass:"q-gutter-y-md"},[o("q-input",{attrs:{color:"primary",outlined:"",type:"email",label:"Username"},scopedSlots:t._u([{key:"prepend",fn:function(){return[o("q-icon",{attrs:{name:"mdi-account"}})]},proxy:!0}]),model:{value:t.email,callback:function(e){t.email=e},expression:"email"}}),o("q-input",{attrs:{color:"primary",outlined:"",type:"password",label:"Password"},scopedSlots:t._u([{key:"prepend",fn:function(){return[o("q-icon",{attrs:{name:"mdi-lock"}})]},proxy:!0}]),model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1)],1),o("q-card-actions",{staticClass:"q-px-lg"},[o("q-btn",{staticClass:"full-width text-white",attrs:{unelevated:"",size:"lg",color:"primary",label:"Sign In"},on:{click:function(e){return t.login_action()}}})],1),o("q-card-section",{staticClass:"text-center q-pa-sm"},[o("p",{staticClass:"text-grey-6"},[t._v(" Forgot your password? ")]),o("p",[t._v("Not a registered user ? Register "),o("router-link",{attrs:{to:"/register"}},[t._v("here")])],1)])],1)])])},n=[],a=o("2a19"),i=o("c993"),r={name:"Login",data(){return{email:"",password:"",imageSrc:"logo.png"}},methods:{login_action:function(){console.log(this.email+this.password),this.connect_jwt()},connect_websocket:function(){const t=this.$store;document.cookie="authorization="+this.$q.localStorage.getItem("token")+";";const e="ws://127.0.0.1:8000/ws/ticker/?"+this.$q.localStorage.getItem("token"),o=new WebSocket(e);o.onopen=function(){o.send(JSON.stringify({type:"ticker_request",message:"Please send all symbols"})),o.send(JSON.stringify({type:"vendor_request",message:"Please send all vendors"}))},o.onmessage=function(e){var o=JSON.parse(e.data);if(o.instruments){var s=JSON.parse(o.instruments);let e=JSON.parse(o.favourites);e=e.map((t=>t.instrument_id)),s=s.map((t=>(t.is_favourite=!1,t)));for(let t=0;t<s.length;t++)for(let o=0;o<e.length;o++)e[o]===s[t].instrument_id&&(console.log("setting instrument"),s[t].is_favourite=!0);console.log(e),console.log(s),t.dispatch("push_instruments",s)}if(o.gold_tick&&t.dispatch("update_prices",o),o.instrument_update){console.log("instrument_update received"),console.log(o);var n=JSON.parse(o.instrument_update);console.log(n),t.dispatch("update_instrument",n)}if(o.vendors){console.log(o.vendors);var a=o.vendors.map((t=>(t.theme=JSON.parse(t.theme)[0],t.vendor_details=JSON.parse(t.vendor_details)[0],t)));t.dispatch("push_vendors",a)}o.order_update&&console.log(o)},o.onclose=function(t){console.log(t),setTimeout((function(){this.connect_jwt()}),2e3)}},connect_jwt:function(){const t=this.$store,e=this.$router;console.log(t);var s=o("bc3a"),n={username:this.email,password:this.password},r={method:"post",url:i["c"]+"/api/rest-auth/login/",headers:{"Content-Type":"application/json"},data:n};const c=this.$q;s(r).then((function(o){console.log(c.localStorage.getItem("token")),t.dispatch("set_token",o.data.key),console.log("before checking"+c.localStorage.getItem("token")),c.localStorage.set("token",o.data.key),console.log("pushing to home"),e.push("Home")})).catch((function(t){console.log(t),a["a"].create({message:t.toString(),position:"top",timeout:5e3})}))}},props:["message"]},c=r,l=(o("f72d"),o("2877")),d=o("a370"),p=o("068f"),u=o("eb85"),m=o("0378"),g=o("27f9"),f=o("0016"),h=o("4b7e"),_=o("9c40"),w=o("f09f"),v=o("eebe"),k=o.n(v),q=Object(l["a"])(c,s,n,!1,null,"06cae340",null);e["default"]=q.exports;k()(q,"components",{QCardSection:d["a"],QImg:p["a"],QSeparator:u["a"],QForm:m["a"],QInput:g["a"],QIcon:f["a"],QCardActions:h["a"],QBtn:_["a"],QCard:w["a"]})},"987f":function(t,e,o){},f72d:function(t,e,o){"use strict";o("987f")}}]);